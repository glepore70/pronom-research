Clam AntiVirus (ClamAV) is a free software, cross-platform antimalware toolkit able to detect many types of malware, including viruses. It was developed for Unix and has third party versions available for AIX, BSD, HP-UX, Linux, macOS, OpenVMS, OSF (Tru64) and Solaris. As of version 0.97.5, ClamAV builds and runs on Microsoft Windows.[2][3] Both ClamAV and its updates are made available free of charge. One of its main uses is on mail servers as a server-side email virus scanner.

Sourcefire, developer of intrusion detection products and the owner of Snort, announced on 17 August 2007 that it had acquired the trademarks and copyrights to ClamAV from five key developers.[4] Upon joining Sourcefire, the ClamAV team joined the Sourcefire Vulnerability Research Team (VRT). In turn, Cisco acquired Sourcefire in 2013.[5] The Sourcefire VRT became Cisco Talos,[6] and ClamAV development remains there.

https://en.wikipedia.org/wiki/Clam_AntiVirus

2. FreshClam checks the ClamAV virus database directory (indicated by the DatabaseDirectory value in the freshclam.conf that FreshClam uses) for existing instances of main.cvd, daily.cvd, or bytecode.cvd. For main and daily, if the CVD can’t be found it also looks for main.cld and daily.cld. These CLD files are uncompressed and unsigned versions of the CVD that have had CDIFFs applied.

3. For any of the official signature sets that can’t be found, FreshClam will download the corresponding CVD from the server indicated by DatabaseMirror in freshclam.conf (the default is database.clamav.net). This is an expensive operation in terms of bandwidth because daily.cvd and main.cvd are, currently, 105 MB and 117 MB, respectively. For the official signature sets that exist on disk, though, FreshClam copies them to a temporary directory and attempts to update them in place using signed CDIFF files.

A ClamAV CDIFF file is generated every time a new release of the daily.cvd or main.cvd is made, and the files exist on the mirror server using the following format: <database name>-<database version>.cdiff. For example, the CDIFF for daily corresponding to the DNS record shown above would be daily-26104.cdiff. Each CDIFF contains the lines to be added or removed to the various text-based ClamAV signature files in the CVD, and these CDIFFs are relatively small, even when many signatures have been added or removed. For example, for an update where 10,000 signatures were removed from daily, the corresponding CDIFF was only around 60 KB in size.

To update via CDIFF, FreshClam determines the version of the database on disk and requests every CDIFF between that version and the latest. Assuming each of those CDIFFs exists on the server (only the last 90 days worth are currently kept) and is downloaded successfully, FreshClam will apply them in order until the CVD has been successfully updated. If a CDIFF cannot be downloaded successfully, FreshClam will stop attempting to apply CDIFFs and will download the CVD directly. On rare occasions, the ClamAV team may intentionally publish a CDIFF that is empty. A zero-byte CDIFF indicates that FreshClam should download the CVD instead. This is sometimes preferred to patching when a significant portion of the CVD changes, like when a large portion of daily is migrated to main in a single update.

https://blog.clamav.net/2021/03/clamav-cvds-cdiffs-and-magic-behind.html
